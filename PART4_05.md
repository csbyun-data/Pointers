🔹 4.4 메모리 누수 문제 (Memory Leak)  
✅ 개요

**메모리 누수(Memory Leak)** 란,
동적으로 할당한 메모리를 해제하지 않고 프로그램이 종료되거나 루프를 반복하는 경우를 말합니다.

이로 인해:

* 시스템 메모리가 점점 고갈

* 프로그램 성능 저하

* 장시간 실행되는 서비스에서 치명적 누수 발생 가능

✅ 예시 1: 해제를 깜빡한 경우
```cpp
void memoryLeak() {
    int* p = new int(100);
    // delete p;  ❌ 빠짐 → 메모리 누수
}
```

이 함수가 여러 번 호출되면 힙에 메모리가 계속 남아 사용되지 않게 됩니다.

✅ 예시 2: 포인터 재할당 시 이전 메모리 해제 누락
```cpp
int* p = new int(10);
p = new int(20);  // ❌ 이전 메모리 주소는 잃어버림 (누수 발생)
```

📌 새로운 주소를 할당하기 전에 delete로 기존 메모리를 해제해야 합니다.

✅ 누수의 흔한 발생 지점
| 상황         | 설명                                   |
| ---------- | ------------------------------------ |
| 예외 발생 시    | try 블록에서 new 후, 예외 발생으로 delete 실행 안됨 |
| 복잡한 분기 구조  | 일부 경로에서만 delete 누락                   |
| 재할당        | 기존 메모리 해제 없이 new 다시 호출               |
| 반환된 포인터    | 사용한 후 해제하지 않음                        |
| 구조체/클래스 멤버 | 멤버 포인터를 소멸자에서 해제하지 않음                |

✅ 예외 발생 시 누수 방지 예 (기본 방식)
```cpp
int* p = new int(50);
try {
    // 코드 중 예외 발생 가능
    throw "error!";
    delete p;  // ❌ 실행되지 않음
} catch (...) {
    std::cout << "예외 처리 중\n";
}
```
해결책: RAII 혹은 스마트 포인터 사용
✅ 해결 방법 정리
| 방법         | 설명                                       |
| ---------- | ---------------------------------------- |
| delete 명시  | 모든 new에는 반드시 delete 필요                   |
| 스마트 포인터 사용 | `std::unique_ptr`, `std::shared_ptr` 활용  |
| RAII 적용    | 생성자에서 할당 → 소멸자에서 해제                      |
| 분석 도구 사용   | Valgrind, Visual Leak Detector 등으로 추적 가능 |

✅ 스마트 포인터 예: 메모리 자동 관리
```cpp
#include <memory>

void safeFunc() {
    std::unique_ptr<int> p = std::make_unique<int>(100);
    // 함수 끝나면 자동 delete → 누수 없음
}
```
✅ 메모리 누수 확인 도구 예 (간단 설명)
| 도구                                 | 설명                       |
| ---------------------------------- | ------------------------ |
| **Valgrind** (Linux)               | 런타임 메모리 누수 검사 도구         |
| **Visual Leak Detector** (Windows) | Visual Studio용 누수 분석기    |
| **AddressSanitizer**               | GCC/Clang 지원, 강력한 메모리 검사 |

📌 요약
| 항목      | 설명                                      |
| ------- | --------------------------------------- |
| 메모리 누수란 | 동적으로 할당한 메모리를 해제하지 않음                   |
| 증상      | 메모리 사용량 증가, 성능 저하, 시스템 불안정              |
| 원인      | delete 누락, 예외 처리 부재, 재할당 시 해제 누락 등      |
| 해결책     | RAII, 스마트 포인터, 분석 도구 사용, 구조화된 메모리 관리 습관 |
